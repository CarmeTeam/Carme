#!/bin/bash
#-----------------------------------------------------------------------------------------------------------------------------------
# Copyright 2022 by CarmeTeam @ CC-HPC Fraunhofer ITWM
# License: http://open-carme.org/LICENSE.md
#-----------------------------------------------------------------------------------------------------------------------------------


# add repos and update -----------------------------------------------------------------------------------------------------------
#echo "deb http://security.debian.org/ stable/updates main" >> /etc/apt/sources.list
echo "deb http://security.debian.org/debian-security stable-security main" >> /etc/apt/sources.list

apt update
apt upgrade -y
#---------------------------------------------------------------------------------------------------------------------------------


# install basic packages ---------------------------------------------------------------------------------------------------------
apt install -y bash-completion fd-find fzf htop less locales man-db nano rsync screen time tmux unzip vim wget zip
echo "en_US.UTF-8 UTF-8" > /etc/locale.gen
dpkg-reconfigure --frontend=noninteractive locales
#---------------------------------------------------------------------------------------------------------------------------------


# install development tools --------------------------------------------------------------------------------------------------------------
apt install -y automake build-essential cmake colordiff g++ gawk gcc gdb gfortran git shellcheck
#---------------------------------------------------------------------------------------------------------------------------------


# install ssh --------------------------------------------------------------------------------------------------------------------
apt install -y openssh-server
#---------------------------------------------------------------------------------------------------------------------------------


# install openmpi ----------------------------------------------------------------------------------------------------------------
apt install -y openmpi-bin libopenmpi-dev
#---------------------------------------------------------------------------------------------------------------------------------


# install packges needed for IB --------------------------------------------------------------------------------------------------
apt install -y libibverbs1 libibverbs-dev librdmacm1 libibmad5 libibumad3 librdmacm1 ibverbs-providers rdmacm-utils infiniband-diags libfabric1 ibverbs-utils
#---------------------------------------------------------------------------------------------------------------------------------


# clean up -------------------------------------------------------------------------------------------------------------------------
apt autoremove --purge -y
apt clean
#-----------------------------------------------------------------------------------------------------------------------------------
